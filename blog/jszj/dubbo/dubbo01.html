<!DOCTYPE html>
<html lang="zh-CN" data-theme="light">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <meta name="generator" content="VuePress 2.0.0-beta.53" />
    <meta name="theme" content="VuePress Theme Hope" />
    <title>Dubbo 架构演进：从 RMI 到 Dubbo | 不会说话的刘同学</title><meta name="description" content="">
    <style>
      :root {
        --bg-color: #fff;
      }

      html[data-theme="dark"] {
        --bg-color: #1d2025;
      }

      html,
      body {
        background: var(--bg-color);
      }
    </style>
    <script>
      const userMode = localStorage.getItem("vuepress-theme-hope-scheme");
      const systemDarkMode =
        window.matchMedia &&
        window.matchMedia("(prefers-color-scheme: dark)").matches;

      if (userMode === "dark" || (userMode !== "light" && systemDarkMode)) {
        document.querySelector("html").setAttribute("data-theme", "dark");
      }
    </script>
    <link rel="preload" href="/assets/style.2a20173f.css" as="style" /><link rel="stylesheet" href="/assets/style.2a20173f.css" />
    <link rel="modulepreload" href="/assets/app.35bbfe3f.js"><link rel="modulepreload" href="/assets/framework.3bd681ae.js"><link rel="modulepreload" href="/assets/dubbo01.html.5e39b4d8.js"><link rel="modulepreload" href="/assets/dubbo01.html.bbc46f5b.js"><link rel="prefetch" href="/assets/index.html.6302c952.js" as="script" /><link rel="prefetch" href="/assets/slides.html.769cd08f.js" as="script" /><link rel="prefetch" href="/assets/disable.html.490b54c9.js" as="script" /><link rel="prefetch" href="/assets/encrypt.html.de5ee159.js" as="script" /><link rel="prefetch" href="/assets/markdown.html.1471d76f.js" as="script" /><link rel="prefetch" href="/assets/page.html.00e85374.js" as="script" /><link rel="prefetch" href="/assets/index.html.6f3e5a3f.js" as="script" /><link rel="prefetch" href="/assets/index.html.263d2fb8.js" as="script" /><link rel="prefetch" href="/assets/index.html.d8e60229.js" as="script" /><link rel="prefetch" href="/assets/slides.html.4cdda82b.js" as="script" /><link rel="prefetch" href="/assets/index.html.31f3f08b.js" as="script" /><link rel="prefetch" href="/assets/index.html.c8622ca2.js" as="script" /><link rel="prefetch" href="/assets/index.html.86748799.js" as="script" /><link rel="prefetch" href="/assets/baz.html.5c7451df.js" as="script" /><link rel="prefetch" href="/assets/index.html.02c24faf.js" as="script" /><link rel="prefetch" href="/assets/ray.html.1203ed64.js" as="script" /><link rel="prefetch" href="/assets/index.html.c5d409c3.js" as="script" /><link rel="prefetch" href="/assets/disable.html.67b6b72d.js" as="script" /><link rel="prefetch" href="/assets/encrypt.html.14fba031.js" as="script" /><link rel="prefetch" href="/assets/markdown.html.0ceb0572.js" as="script" /><link rel="prefetch" href="/assets/page.html.2bb5957b.js" as="script" /><link rel="prefetch" href="/assets/index.html.5da7f899.js" as="script" /><link rel="prefetch" href="/assets/index.html.52d7fb2c.js" as="script" /><link rel="prefetch" href="/assets/HashMap.html.19899616.js" as="script" /><link rel="prefetch" href="/assets/javaio01.html.af77d623.js" as="script" /><link rel="prefetch" href="/assets/javaio02.html.1b65a673.js" as="script" /><link rel="prefetch" href="/assets/Thread01.html.f28c9834.js" as="script" /><link rel="prefetch" href="/assets/Redis02.html.01ce2589.js" as="script" /><link rel="prefetch" href="/assets/Redis03.html.7dae2903.js" as="script" /><link rel="prefetch" href="/assets/Redis04.html.5463d105.js" as="script" /><link rel="prefetch" href="/assets/Spring01.html.70cb02de.js" as="script" /><link rel="prefetch" href="/assets/spring_01.html.cda93c86.js" as="script" /><link rel="prefetch" href="/assets/index.html.443b7d4d.js" as="script" /><link rel="prefetch" href="/assets/index.html.b46b5995.js" as="script" /><link rel="prefetch" href="/assets/index.html.ac4baaf9.js" as="script" /><link rel="prefetch" href="/assets/baz.html.fb0944a3.js" as="script" /><link rel="prefetch" href="/assets/index.html.1ce677c5.js" as="script" /><link rel="prefetch" href="/assets/ray.html.a251e01e.js" as="script" /><link rel="prefetch" href="/assets/index.html.120c630c.js" as="script" /><link rel="prefetch" href="/assets/redis_01.html.af4cd3ce.js" as="script" /><link rel="prefetch" href="/assets/spring_01.html.2bbcb8ab.js" as="script" /><link rel="prefetch" href="/assets/404.html.da9ed260.js" as="script" /><link rel="prefetch" href="/assets/index.html.862bceef.js" as="script" /><link rel="prefetch" href="/assets/slides.html.46e59222.js" as="script" /><link rel="prefetch" href="/assets/disable.html.a2f24051.js" as="script" /><link rel="prefetch" href="/assets/encrypt.html.9e34418b.js" as="script" /><link rel="prefetch" href="/assets/markdown.html.da6de833.js" as="script" /><link rel="prefetch" href="/assets/page.html.4879c622.js" as="script" /><link rel="prefetch" href="/assets/index.html.1a49309e.js" as="script" /><link rel="prefetch" href="/assets/index.html.6e5a7f5f.js" as="script" /><link rel="prefetch" href="/assets/index.html.ee30200e.js" as="script" /><link rel="prefetch" href="/assets/slides.html.7e73a934.js" as="script" /><link rel="prefetch" href="/assets/index.html.ed3bf23e.js" as="script" /><link rel="prefetch" href="/assets/index.html.da7151af.js" as="script" /><link rel="prefetch" href="/assets/index.html.9b27611e.js" as="script" /><link rel="prefetch" href="/assets/baz.html.0d459fe8.js" as="script" /><link rel="prefetch" href="/assets/index.html.ac92337a.js" as="script" /><link rel="prefetch" href="/assets/ray.html.ddb77a54.js" as="script" /><link rel="prefetch" href="/assets/index.html.c6a3cba9.js" as="script" /><link rel="prefetch" href="/assets/disable.html.b8cea077.js" as="script" /><link rel="prefetch" href="/assets/encrypt.html.147d5b28.js" as="script" /><link rel="prefetch" href="/assets/markdown.html.f2659120.js" as="script" /><link rel="prefetch" href="/assets/page.html.b19adaaf.js" as="script" /><link rel="prefetch" href="/assets/index.html.81890044.js" as="script" /><link rel="prefetch" href="/assets/index.html.c6b39350.js" as="script" /><link rel="prefetch" href="/assets/HashMap.html.c0577445.js" as="script" /><link rel="prefetch" href="/assets/javaio01.html.51b6a59f.js" as="script" /><link rel="prefetch" href="/assets/javaio02.html.0ab43469.js" as="script" /><link rel="prefetch" href="/assets/Thread01.html.8fd99f04.js" as="script" /><link rel="prefetch" href="/assets/Redis02.html.e68acc4e.js" as="script" /><link rel="prefetch" href="/assets/Redis03.html.309e9054.js" as="script" /><link rel="prefetch" href="/assets/Redis04.html.c6272091.js" as="script" /><link rel="prefetch" href="/assets/Spring01.html.48e26027.js" as="script" /><link rel="prefetch" href="/assets/spring_01.html.bb9193bd.js" as="script" /><link rel="prefetch" href="/assets/index.html.83ea3c15.js" as="script" /><link rel="prefetch" href="/assets/index.html.616f1611.js" as="script" /><link rel="prefetch" href="/assets/index.html.4239acbb.js" as="script" /><link rel="prefetch" href="/assets/baz.html.b483d0dd.js" as="script" /><link rel="prefetch" href="/assets/index.html.206afcce.js" as="script" /><link rel="prefetch" href="/assets/ray.html.6be27ed1.js" as="script" /><link rel="prefetch" href="/assets/index.html.03d5605d.js" as="script" /><link rel="prefetch" href="/assets/redis_01.html.75bdf6f2.js" as="script" /><link rel="prefetch" href="/assets/spring_01.html.e595012a.js" as="script" /><link rel="prefetch" href="/assets/404.html.cc54d8af.js" as="script" /><link rel="prefetch" href="/assets/photoswipe.esm.720e8656.js" as="script" />
  </head>
  <body>
    <div id="app"><!--[--><!--[--><!--[--><span tabindex="-1"></span><a href="#main-content" class="skip-link sr-only">跳至主要內容</a><!--]--><div class="theme-container has-toc"><!--[--><!--[--><header class="navbar"><div class="navbar-left"><button class="toggle-sidebar-button" title="Toggle Sidebar"><span class="icon"></span></button><!--[--><!----><!--]--><a href="/" class="brand"><img class="logo" src="/icon.png" alt="不会说话的刘同学"><!----><span class="site-name hide-in-pad">不会说话的刘同学</span></a><!--[--><!----><!--]--></div><div class="navbar-center"><!--[--><!----><!--]--><nav class="nav-links"><div class="nav-item hide-in-mobile"><a href="/blog/jszj/" class="nav-link active" aria-label="技术总结"><span class="icon java"></span>技术总结<!----></a></div><div class="nav-item hide-in-mobile"><a href="/blog/ymxl/" class="nav-link" aria-label="源码系列"><span class="icon java"></span>源码系列<!----></a></div><div class="nav-item hide-in-mobile"><a href="/blog/msfx/" class="nav-link" aria-label="面试复习"><span class="icon java"></span>面试复习<!----></a></div></nav><!--[--><!----><!--]--></div><div class="navbar-right"><!--[--><!----><!--]--><!----><div class="nav-item"><a class="repo-link" href="https://github.com/JavaLiuTongXue/JavaCoding" target="_blank" rel="noopener noreferrer" aria-label="GitHub"><svg xmlns="http://www.w3.org/2000/svg" class="icon github-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="github icon" style="width:1.25rem;height:1.25rem;vertical-align:middle;"><path d="M511.957 21.333C241.024 21.333 21.333 240.981 21.333 512c0 216.832 140.544 400.725 335.574 465.664 24.49 4.395 32.256-10.07 32.256-23.083 0-11.69.256-44.245 0-85.205-136.448 29.61-164.736-64.64-164.736-64.64-22.315-56.704-54.4-71.765-54.4-71.765-44.587-30.464 3.285-29.824 3.285-29.824 49.195 3.413 75.179 50.517 75.179 50.517 43.776 75.008 114.816 53.333 142.762 40.79 4.523-31.66 17.152-53.377 31.19-65.537-108.971-12.458-223.488-54.485-223.488-242.602 0-53.547 19.114-97.323 50.517-131.67-5.035-12.33-21.93-62.293 4.779-129.834 0 0 41.258-13.184 134.912 50.346a469.803 469.803 0 0 1 122.88-16.554c41.642.213 83.626 5.632 122.88 16.554 93.653-63.488 134.784-50.346 134.784-50.346 26.752 67.541 9.898 117.504 4.864 129.834 31.402 34.347 50.474 78.123 50.474 131.67 0 188.586-114.73 230.016-224.042 242.09 17.578 15.232 33.578 44.672 33.578 90.454v135.85c0 13.142 7.936 27.606 32.854 22.87C862.25 912.597 1002.667 728.747 1002.667 512c0-271.019-219.648-490.667-490.71-490.667z"></path></svg></a></div><div class="nav-item hide-in-mobile"><button id="appearance-switch"><svg xmlns="http://www.w3.org/2000/svg" class="icon auto-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="auto icon" style="display:block;"><path d="M512 992C246.92 992 32 777.08 32 512S246.92 32 512 32s480 214.92 480 480-214.92 480-480 480zm0-840c-198.78 0-360 161.22-360 360 0 198.84 161.22 360 360 360s360-161.16 360-360c0-198.78-161.22-360-360-360zm0 660V212c165.72 0 300 134.34 300 300 0 165.72-134.28 300-300 300z"></path></svg><svg xmlns="http://www.w3.org/2000/svg" class="icon dark-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="dark icon" style="display:none;"><path d="M524.8 938.667h-4.267a439.893 439.893 0 0 1-313.173-134.4 446.293 446.293 0 0 1-11.093-597.334A432.213 432.213 0 0 1 366.933 90.027a42.667 42.667 0 0 1 45.227 9.386 42.667 42.667 0 0 1 10.24 42.667 358.4 358.4 0 0 0 82.773 375.893 361.387 361.387 0 0 0 376.747 82.774 42.667 42.667 0 0 1 54.187 55.04 433.493 433.493 0 0 1-99.84 154.88 438.613 438.613 0 0 1-311.467 128z"></path></svg><svg xmlns="http://www.w3.org/2000/svg" class="icon light-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="light icon" style="display:none;"><path d="M952 552h-80a40 40 0 0 1 0-80h80a40 40 0 0 1 0 80zM801.88 280.08a41 41 0 0 1-57.96-57.96l57.96-58a41.04 41.04 0 0 1 58 58l-58 57.96zM512 752a240 240 0 1 1 0-480 240 240 0 0 1 0 480zm0-560a40 40 0 0 1-40-40V72a40 40 0 0 1 80 0v80a40 40 0 0 1-40 40zm-289.88 88.08-58-57.96a41.04 41.04 0 0 1 58-58l57.96 58a41 41 0 0 1-57.96 57.96zM192 512a40 40 0 0 1-40 40H72a40 40 0 0 1 0-80h80a40 40 0 0 1 40 40zm30.12 231.92a41 41 0 0 1 57.96 57.96l-57.96 58a41.04 41.04 0 0 1-58-58l58-57.96zM512 832a40 40 0 0 1 40 40v80a40 40 0 0 1-80 0v-80a40 40 0 0 1 40-40zm289.88-88.08 58 57.96a41.04 41.04 0 0 1-58 58l-57.96-58a41 41 0 0 1 57.96-57.96z"></path></svg></button></div><!----><!--[--><!----><!--]--><button class="toggle-navbar-button" aria-label="Toggle Navbar" aria-expanded="false" aria-controls="nav-screen"><span class="button-container"><span class="button-top"></span><span class="button-middle"></span><span class="button-bottom"></span></span></button></div></header><!----><!--]--><!----><div class="toggle-sidebar-wrapper"><span class="arrow left"></span></div><aside class="sidebar"><!--[--><!----><!--]--><ul class="sidebar-links"><li><section class="sidebar-group"><button class="sidebar-heading clickable"><span class="icon creative"></span><span class="title">Java IO</span><span class="arrow right"></span></button><!----></section></li><li><section class="sidebar-group"><button class="sidebar-heading clickable"><span class="icon creative"></span><span class="title">集合框架</span><span class="arrow right"></span></button><!----></section></li><li><section class="sidebar-group"><button class="sidebar-heading clickable"><span class="icon creative"></span><span class="title">多线程</span><span class="arrow right"></span></button><!----></section></li><li><section class="sidebar-group"><button class="sidebar-heading clickable"><span class="icon creative"></span><span class="title">线程池</span><span class="arrow right"></span></button><!----></section></li><li><section class="sidebar-group"><button class="sidebar-heading clickable"><span class="icon creative"></span><span class="title">JVM</span><span class="arrow right"></span></button><!----></section></li><li><section class="sidebar-group"><button class="sidebar-heading clickable"><span class="icon creative"></span><span class="title">JDK并发工具</span><span class="arrow right"></span></button><!----></section></li><li><section class="sidebar-group"><button class="sidebar-heading clickable"><span class="icon creative"></span><span class="title">Spring</span><span class="arrow right"></span></button><!----></section></li><li><section class="sidebar-group"><button class="sidebar-heading clickable"><span class="icon creative"></span><span class="title">Mysql</span><span class="arrow right"></span></button><!----></section></li><li><section class="sidebar-group"><button class="sidebar-heading clickable"><span class="icon creative"></span><span class="title">Redis</span><span class="arrow right"></span></button><!----></section></li><li><section class="sidebar-group"><button class="sidebar-heading clickable active"><span class="icon creative"></span><span class="title">分布式框架</span><span class="arrow down"></span></button><ul class="sidebar-links"><li><section class="sidebar-group"><button class="sidebar-heading clickable active"><span class="icon creative"></span><span class="title">Dubbo</span><span class="arrow down"></span></button><ul class="sidebar-links"><li><!--[--><a aria-current="page" href="/blog/jszj/dubbo/dubbo01.html" class="router-link-active router-link-exact-active nav-link active sidebar-link sidebar-page active" aria-label="Dubbo 架构演进：从 RMI 到 Dubbo"><!---->Dubbo 架构演进：从 RMI 到 Dubbo<!----></a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a aria-current="page" href="/blog/jszj/dubbo/dubbo01.html#自定义-rpc" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="自定义 RPC"><!---->自定义 RPC<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/blog/jszj/dubbo/dubbo01.html#rmi-架构" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="RMI 架构"><!---->RMI 架构<!----></a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a aria-current="page" href="/blog/jszj/dubbo/dubbo01.html#整体架构" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="整体架构"><!---->整体架构<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/blog/jszj/dubbo/dubbo01.html#rpc-调用" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="RPC 调用"><!---->RPC 调用<!----></a><ul class="sidebar-sub-headers"></ul></li></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/blog/jszj/dubbo/dubbo01.html#dubbo-架构" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="Dubbo 架构"><!---->Dubbo 架构<!----></a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a aria-current="page" href="/blog/jszj/dubbo/dubbo01.html#整体架构-1" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="整体架构"><!---->整体架构<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/blog/jszj/dubbo/dubbo01.html#rpc-调用-1" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="RPC 调用"><!---->RPC 调用<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/blog/jszj/dubbo/dubbo01.html#服务治理" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="服务治理"><!---->服务治理<!----></a><ul class="sidebar-sub-headers"></ul></li></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/blog/jszj/dubbo/dubbo01.html#总结时刻" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="总结时刻"><!---->总结时刻<!----></a><ul class="sidebar-sub-headers"></ul></li></ul><!--]--></li></ul></section></li><li><section class="sidebar-group"><button class="sidebar-heading clickable"><span class="icon creative"></span><span class="title">Zookeeper</span><span class="arrow right"></span></button><!----></section></li></ul></section></li><li><section class="sidebar-group"><button class="sidebar-heading clickable"><span class="icon creative"></span><span class="title">消息队列</span><span class="arrow right"></span></button><!----></section></li><li><section class="sidebar-group"><button class="sidebar-heading clickable"><span class="icon creative"></span><span class="title">微服务</span><span class="arrow right"></span></button><!----></section></li><li><section class="sidebar-group"><button class="sidebar-heading clickable"><span class="icon creative"></span><span class="title">分布式事务</span><span class="arrow right"></span></button><!----></section></li><li><section class="sidebar-group"><button class="sidebar-heading clickable"><span class="icon creative"></span><span class="title">分库分表解决方案</span><span class="arrow right"></span></button><!----></section></li></ul><!--[--><!----><!--]--></aside><!--[--><main class="page" id="main-content"><!--[--><!----><nav class="breadcrumb disable"></nav><div class="page-title"><h1><!---->Dubbo 架构演进：从 RMI 到 Dubbo</h1><div class="page-info"><!----><!----><!----><!----><!----><span class="reading-time-info" aria-label="阅读时间⌛" data-balloon-pos="down"><svg xmlns="http://www.w3.org/2000/svg" class="icon timer-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="timer icon"><path d="M799.387 122.15c4.402-2.978 7.38-7.897 7.38-13.463v-1.165c0-8.933-7.38-16.312-16.312-16.312H256.33c-8.933 0-16.311 7.38-16.311 16.312v1.165c0 5.825 2.977 10.874 7.637 13.592 4.143 194.44 97.22 354.963 220.201 392.763-122.204 37.542-214.893 196.511-220.2 389.397-4.661 5.049-7.638 11.651-7.638 19.03v5.825h566.49v-5.825c0-7.379-2.849-13.981-7.509-18.9-5.049-193.016-97.867-351.985-220.2-389.527 123.24-37.67 216.446-198.453 220.588-392.892zM531.16 450.445v352.632c117.674 1.553 211.787 40.778 211.787 88.676H304.097c0-48.286 95.149-87.382 213.728-88.676V450.445c-93.077-3.107-167.901-81.297-167.901-177.093 0-8.803 6.99-15.793 15.793-15.793 8.803 0 15.794 6.99 15.794 15.793 0 80.261 63.69 145.635 142.01 145.635s142.011-65.374 142.011-145.635c0-8.803 6.99-15.793 15.794-15.793s15.793 6.99 15.793 15.793c0 95.019-73.789 172.82-165.96 177.093z"></path></svg><span>大约 8 分钟</span><meta property="timeRequired" content="PT8M"></span></div><hr></div><div class="toc-place-holder"><aside id="toc"><div class="toc-header">此页内容</div><div class="toc-wrapper"><ul class="toc-list"><!--[--><li class="toc-item"><a aria-current="page" href="/blog/jszj/dubbo/dubbo01.html#自定义-rpc" class="router-link-active router-link-exact-active toc-link level2">自定义 RPC</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/blog/jszj/dubbo/dubbo01.html#rmi-架构" class="router-link-active router-link-exact-active toc-link level2">RMI 架构</a></li><ul class="toc-list"><!--[--><li class="toc-item"><a aria-current="page" href="/blog/jszj/dubbo/dubbo01.html#整体架构" class="router-link-active router-link-exact-active toc-link level3">整体架构</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/blog/jszj/dubbo/dubbo01.html#rpc-调用" class="router-link-active router-link-exact-active toc-link level3">RPC 调用</a></li><!----><!--]--></ul><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/blog/jszj/dubbo/dubbo01.html#dubbo-架构" class="router-link-active router-link-exact-active toc-link level2">Dubbo 架构</a></li><ul class="toc-list"><!--[--><li class="toc-item"><a aria-current="page" href="/blog/jszj/dubbo/dubbo01.html#整体架构-1" class="router-link-active router-link-exact-active toc-link level3">整体架构</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/blog/jszj/dubbo/dubbo01.html#rpc-调用-1" class="router-link-active router-link-exact-active toc-link level3">RPC 调用</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/blog/jszj/dubbo/dubbo01.html#服务治理" class="router-link-active router-link-exact-active toc-link level3">服务治理</a></li><!----><!--]--></ul><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/blog/jszj/dubbo/dubbo01.html#总结时刻" class="router-link-active router-link-exact-active toc-link level2">总结时刻</a></li><!----><!--]--></ul></div></aside></div><!----><div class="theme-hope-content"><h1 id="dubbo-架构演进-从-rmi-到-dubbo" tabindex="-1"><a class="header-anchor" href="#dubbo-架构演进-从-rmi-到-dubbo" aria-hidden="true">#</a> Dubbo 架构演进：从 RMI 到 Dubbo</h1><blockquote><p>注：本文转载自https://www.cnblogs.com/binarylei/p/14110008.html</p></blockquote><p>谈谈你对 Dubbo 的认知？对于这个问题，你是怎么回答的呢？</p><p>我们知道 Dubbo 是从 RPC 起家，到现在则已经发展成为一个微服务的治理框架。所以，要回好上面的问题，关键是二点：Dubbo 是<strong>如何进行 RPC 通信</strong>，二是 Dubbo 是<strong>如何进行服务治理</strong>。</p><p>本文试图从 Dubbo 的架构演进来回答上述问题，包括：一是最原始的 RPC 通信如何实现；二是分析传统的 JDK RMI 架构模型，并指出它的不足；三是 Dubbo 又在 RMI 的基础上做了那些改进？</p><h2 id="自定义-rpc" tabindex="-1"><a class="header-anchor" href="#自定义-rpc" aria-hidden="true">#</a> 自定义 RPC</h2><p>如果我们要实现自己的 Java RPC，即直接通过 socket 将参数发送给服务端，我们需要那些发送那些参数呢？首先是类名(serviceName)、方法名(methodName)、方法参数类型(parameterTypes)、以及具体的参数(args)。其中前三个是定位信息，可以定位到具体实现类的具体方法，最后通过 method.invoke(args) 反射执行方法。代码实现参考文章《<a href="https://www.cnblogs.com/zyl2016/p/9875593.html" target="_blank" rel="noopener noreferrer">实现自己的 Java RPC<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a>》。</p><p>在我们自己实现的 Java RPC 中，分为两层：第一层是应用层，第二层是网络层。这样网络层代码就会侵入应用层，怎么解决这个问题呢？其实我们可以给 service 生成一个代理类 proxy，由代理类负责所有的网络通信，这就是 Java RMI 在改进措施，同时 RMI 还提供了服务注册与发现的功能。</p><p><img src="https://p1-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/812ff2a82d52406e916b4570566068db~tplv-k3u1fbpfcp-watermark.image?" alt="image.png"></p><h2 id="rmi-架构" tabindex="-1"><a class="header-anchor" href="#rmi-架构" aria-hidden="true">#</a> RMI 架构</h2><h3 id="整体架构" tabindex="-1"><a class="header-anchor" href="#整体架构" aria-hidden="true">#</a> 整体架构</h3><p>RMI 的具体源码分析见《<a href="https://www.cnblogs.com/binarylei/p/12115986.html" target="_blank" rel="noopener noreferrer">RMI 源码分析<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a>》，这里只是着重分析其架构设计。在 RMI 中有三个角色：注册中心（Registry）、客户端（Client）、服务端（Server）。</p><p><img src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/302d7d4b5ab842479d9a573e60cb4d34~tplv-k3u1fbpfcp-watermark.image?" alt="image.png"></p><p><strong>说明：</strong> 这张图大家都很熟悉了，我就不再多说。在整个 RMI 中，提出了一个非常核心的概念：<strong>Stub（存根） 和 Skeleton（骨架）</strong> 。这翻译其实有点古怪，后面还是叫 Stub 和 Skeleton。之后的 RPC 框架基本上都沿用了这个概念，客户端 Stub 和服务端 Skeleton 是 Service 的代理对象，专门用于屏蔽网络通信。</p><h3 id="rpc-调用" tabindex="-1"><a class="header-anchor" href="#rpc-调用" aria-hidden="true">#</a> RPC 调用</h3><p>有了 Stub 和 Skeleton 那服务之间的调用就变成了下面这样：</p><p><img src="https://p9-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/5cdb9eb210a14ecb910fd90c2c04607a~tplv-k3u1fbpfcp-watermark.image?" alt="image.png"></p><p><strong>说明：</strong> 在上图中我们可以很清楚的看到，所有和网络通信相关的都封装在了 Stub 和 Skeleton 中。相对来说，服务端 Skeleton 的概念其实有点虚，在 RMI 中并没能一个明确的对象，而客户端 Stub 是接口 Service 的代理对象。这样整个服务注册、发现及调用过程如下：</p><p>1.<strong>服务注册（1 ~ 2）</strong></p><ul><li>第一步：服务端创建远程对象。一是创建 ServiceImpl 远程对象；二是注册 ServiceImpl 服务。ServiceImpl 继承自 UnicastRemoteObject，在创建时默认会随机绑定一个端口，启动 Socket 来监听客户端的请求</li><li>第二步：向注册中心注册该服务。<strong>注意：和其它的注册中心不同，Registry 只能注册本地服务。</strong></li></ul><p>2.<strong>服务发现（3 ~ 4）</strong></p><ul><li>客户端访问注册中心，会将服务端生成的 Stub 序列化后传给客户端，客户端反序列化后生成一个对应的实例。之后，就可以使用这个 Stub 和服务端进行通信了。**注意：Stub 是服务端生成的，使用的时候通过网络传给客户端。</li></ul><ol start="3"><li><strong>服务调用（5 ~ 9）</strong></li></ol><ul><li>客户端存根和服务器骨架通信，返回结果。有一个很关键的问题，Stub 调用时是如何找到要调用的方法的？<strong>Java</strong> RPC 调用远程方法需要四元组信息：接口名、方法名称、参数类型、参数。服务端注册服务时每个 Service 都会生成一个 ObjID，并封装在 Stub 中。同时 Java 类中每一个方法都会对应唯一的编号 opum，每次通信时 Stub 都会将 ObjId 和 opum 发送给服务方。</li></ul><p>这样 RMI 其实就可以分为三层：</p><p><img src="https://p9-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/85b6481ae6d5468c867475f2e705c9ba~tplv-k3u1fbpfcp-watermark.image?" alt="image.png"></p><p><strong>说明：</strong> 后续的 RPC 框架基本沿用了 RMI 的架构，Dubbo 的整体架构和 RMI 基本上差不多，主要是增加了服务治理的功能。RMI 中代理层包括 stub 和 skeleton 两个代理对象，它们既是代理对象（Proxy）也是执行对象（Invoker）。服务治理则是围绕服务实例（ip/port）展开，也就是在执行对象 Invoker 上做文章，而 RMI 中将代理对象和执行对象耦合在一起，导致扩展非常困难。下面，我们就看一下 Dubbo 在 RMI 上的改进。</p><h2 id="dubbo-架构" tabindex="-1"><a class="header-anchor" href="#dubbo-架构" aria-hidden="true">#</a> Dubbo 架构</h2><p>因此，<strong>我认为 Dubbo 相对于 RMI 在架构上最大的改进是：将执行对象</strong> <strong>Invoker</strong> <strong>和代理对象 proxy 分开</strong>。事实上，<strong>Invoker 是 Dubbo 中最核心的领域模型，其服务治理都是围绕 Invoker 做文章</strong>，在读 Dubbo 源码之前，我们脑海中一定要有一个这样的深刻印象。Dubbo 的架构可以参考官网的文章《<a href="http://dubbo.apache.org/zh-cn/docs/dev/design.html" target="_blank" rel="noopener noreferrer">Dubbo 框架设计<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a>》。</p><blockquote><p>在 Dubbo 的核心领域模型中，可以看到 Protocol 和 Invocation 实际上也是围绕 Invoker 展开的：</p><ul><li><strong>Protocol</strong> 是服务域，它是 Invoker 暴露和引用的主功能入口，它负责 Invoker 的生命周期管理。</li><li><strong>Invoker</strong> 是实体域，它是 Dubbo 的核心模型，其它模型都向它靠拢，或转换成它，它代表一个可执行体，可向它发起 invoke 调用，它有可能是一个本地的实现，也可能是一个远程的实现，也可能一个集群实现。</li><li><strong>Invocation</strong> 是会话域，它持有调用过程中的变量，比如方法名，参数等。</li></ul></blockquote><h3 id="整体架构-1" tabindex="-1"><a class="header-anchor" href="#整体架构-1" aria-hidden="true">#</a> 整体架构</h3><p>下图是 Dubbo 的整体架构图，可以看到相比于 RMI 而言，变化不大。</p><p><img src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/6bf8bfcda53b47eb94b08527b04113ed~tplv-k3u1fbpfcp-watermark.image?" alt="image.png"></p><p><strong>说明：</strong> 服务治理是 Dubbo 最核心的功能，所有的功能都是围绕 Invoker 展开。下面会逐一分析 Dubbo 服务注册、服务发现、服务调用基本功能，以及其服务治理功能。</p><h3 id="rpc-调用-1" tabindex="-1"><a class="header-anchor" href="#rpc-调用-1" aria-hidden="true">#</a> RPC 调用</h3><p>Dubbo 整个服务注册、发现及调用过程如下：</p><ol><li>服务注册：Dubbo 在注册服务分为两步，需要先将服务实例 service 包装成 <strong>Invoker</strong> 后，再注册服务。</li></ol><ul><li>一是调用 <strong>ProxyFactory#getInvoker</strong> 将 serviceImpl 包装成 Invoker。</li><li>二是调用 <strong>Protocol#export</strong> 注册服务，这个注册服务的过程和 RMI 几乎完全一样，启动 socket 监听，并将 Invoker 包装成 Exporter 保存到一个 Map 集合中，最后注册。</li></ul><ol start="2"><li>服务发现：和服务注册相反，需要生成 <strong>Invoker</strong>，再生成 service 接口的代理类。</li></ol><ul><li>一是调用 <strong>Protocol#refer</strong> 生成 Invoker，这个 Invoker 封装了网络通信。</li><li>二是调用 <strong>ProxyFactory#getProxy</strong> 生成 service 接口的代理类。</li></ul><ol start="3"><li>服务调用：客户端将 <strong>Invocation</strong> 参数发送给服务端，包含接口名称，方法名称，方法参数类型，实际参数。通过 Invocation 前三个参数（接口名、方法名、方法参数）就可以定位到具体的方法，再通过反射调用。</li></ol><p><strong>说明：</strong> 可以看到的是，在整个 RPC 调用过程中都是围绕 Protocol、Invoker、Invocation 这三个核心的领域模型展开。</p><p><img src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/d82c17c90e0b47f2951ac29e58f6c5b5~tplv-k3u1fbpfcp-watermark.image?" alt="image.png"></p><h3 id="服务治理" tabindex="-1"><a class="header-anchor" href="#服务治理" aria-hidden="true">#</a> 服务治理</h3><p>RMI 只是一个纯粹的 RPC 框架，而 Dubbo 现在已经围绕服务治理形成了一个生态。现在我们就看一下 Dubbo 是如何进行服务治理的。Dubbo 的服务治理其实都是对 Invoker 进行处理，服务治理包含以下四个方面。</p><ol><li><p>服务发现：核心接口 Directory。调用 Directory.list() 方法获取注册中心的 <strong>Invoker</strong>，实现类有 StaticDirectory 和 RegistryDirectory。</p></li><li><p>服务路由：核心接口 Router。调用 Router.route(invokers, url, invocation) 来过滤 <strong>Invoker</strong>，实现类有 ConditionRouter（条件路由）、ScriptRouter（脚本路由）等。</p></li><li><p>负载均衡：核心接口 LoadBalance。调用 LoadBalance.select(invokers, url, invocation) 过滤 <strong>Invoker</strong>，实现类有 RandomLoadBalance（随机）、RoundRobinLoadBalance（轮询）、ConsistentHashLoadBalance（一致性Hash）等。</p></li><li><p>集群容错：核心接口 Cluster。调用 Cluster.join(directory) 将多个 invokers 合并成一个 <strong>Invoker</strong>，实现类有 FailbackClusterInvoker（失败恢复）、FailoverClusterInvoker（失败转移）、FailsafeClusterInvoker（安全失败 ）等。</p></li></ol><p>这些接口又是如何配合起来工作的呢？</p><p><img src="https://p9-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/a7775941ab954e0bb367eed76f9489a0~tplv-k3u1fbpfcp-watermark.image?" alt="image.png"></p><h2 id="总结时刻" tabindex="-1"><a class="header-anchor" href="#总结时刻" aria-hidden="true">#</a> 总结时刻</h2><ol><li><p>最简单的 RPC 通信。我们需要发送类名(serviceName)、方法名(methodName)、方法参数类型(parameterTypes)、以及具体的参数(args)这个参数，这些信息在网络通信中一个统一的名称 Invocation。此时，只有应用层和网络层。</p></li><li><p>Java RMI。主要做了两点改进：一是增加代理类 proxy，用于屏蔽网络通信；二是增加服务注册与发现的功能。此时架构分为三层：应用层、代理层、网络层。</p></li><li><p>Dubbo。为了支持服务的注册与发现，Dubbo 将代理层 proxy 抽取出执行体 Invoker，后续的整个服务治理与发现都是围绕 invoker 展开。此时架构分为五层：应用层、代理层、服务治理层(Invoker)、协议层、网络层</p></li></ol></div><!----><footer class="page-meta"><!----><!----><!----></footer><!----><!----><!----><!--]--></main><!--]--><!----><!--]--></div><!--]--><!----><!--]--></div>
    <script type="module" src="/assets/app.35bbfe3f.js" defer></script>
  </body>
</html>
